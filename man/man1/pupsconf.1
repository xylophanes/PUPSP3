.TH PUPSCONF 1 "21st February 2009" "PUPSP3 build tools" "PUPSP3 build tools"

.SH NAME
PUPSCONF \- Makefile configuration facility for PUPS 
.br

.SH SYNOPSIS
.B pupsconf
[
.B -usage
|
.B -help
] | [
.B
[
.B -cdir
.I configuration directory
]!
.I Makefile configuration file name 
!!
.I Template makefile name 
!!
.I Makefile name
[
.B dserial
.I serial number
] | [
.B sdongle
.I dongle file name | dongle key
]
[2> <log file>]
.br

.SH DESCRIPTION
.I pupsconf(1) 
is a utility similar to gnu configure,
.I configure(1)
which generates makefiles from a
.I makefile template
and a
.I configuration file
which contains system dependant makefile fragments to be subsituted in the
makefile.
.I pupsconfig(1)
is both more simple and less versatile than
.I configure(1),
but is useful for generating makefiles for machines/environments which require
different CFLAGS and LDFLAG definitions. The configuration information is stored
in the directory ./config and is of the form:
.br

.DS B
# comment
<macro dummy name to be subsituted 1>
<substition string 1>

# comment
<macro dummy name to be subsituted 1>
<substition string 1>

end
.DE

If the dummy name is not to be subsituted the substitution string "no" or
"none" should be used.  The
.I end
statement at the end of the configuration file is mandatory.
.br

.SH OPTIONS

.B -cdir
.I configuration file
specifies where
.I pupsconf(1)
will find the template used to generate a
.B Makefile
from a
.B Makfile.in
file.
.br

These options are only valid if
.I pupsconf(1)
has been built with
.I secure mode extensions.
.br

.B Makefile configuration file name
is the file which contains the macros to be substituted in the
.B Makefile.in
file
.br


.B Template makefile name
is the
.B Makefile.in
from which the
.B Makefile
is generated.
.br


.B Makefile name
is the name of the
.B Makefile
to be generated.
.br

.B dserial
.I disk serial number
tells
.I pupsconf(1)
to use the hard disk serial number as the software build authentication token when generating makefile. If a
serial number is specified, that is used (enable secure remote build). If not, the serial number
of the disk the software is to be built on is used. This option and
.B sdongle
are
.I mutually exclusive.
.br

.B sdongle
.I dongle file name | dongle key
tells
.I puspconf(1)
to use either the (random) inode of the supplied
.I dongle file
or the supplied
.I dongle key
as the authentication token when generating makefile. If a
.I dongle file name
is specified, it is assumed to be on the disk being used for the build:
.I dongle key
can refer to an appropriate file on the local build disk, or a remote disk, which
means that this option can be used for remote builds.
.B sdongle
and
.I dserial
are
.I mutually exclusive.
.br


.SH EXAMPLE MACRO FILE
.br

# This is the name of the macro
.br
TARGET_CFLAGS
.br
.br

#This is its body
.br
-verbose -DHAVE_MACROS
.br
.br

# End of macro definitions
.br
end
.br

.SH FILES
Makefile.in
.br
Makefile
.br
config_file
.br

.SH EXIT STATUS

255: error
.br
1:
.B -usage
or
.B -help
.br
0: no error
.br

.SH ENVIRONMENT VARIABLES
PUPSCONF gives the name of the directory to be searched for the configuration
file.

If secure build mode extensions are enabled
.B USE_DISK_SERIAL
.I disk_serial
tells
.I pupsconf(1)
to use the disk serial number as the secure authentication token for building the software.
If
.I disk_serial
is specified, it is used as the disk serial, otherwise the build disk is probed for its serial number.
This environmental option and
.B USE_SOFT_DONGLE
are mutually exclusive. Note they disk serial number must be
.I pre-encrypted.
Thus, it is generated by running the
.I hdid(1)
command on the target host:
hdid <disk device>
.br

.B USE_SOFT_DONGLE
.I dongle file name | dongle key
tells
.I pupsconf(1)
to use the (randomised) inode of the specified
.I dongle file
or the specified
.I dongle key
as the secure authentication token for building the software. The
.I dongle file
is assumed to be on the build disk, but the
.I dongle key
can refer to an appropriate file anywhere, permitting soft dongles to be used for
remote builds.  This environmental option and
.B USE_DISK_SERIAL
are mutually exclusive. Note the dongle key
.B must be specified in hex.
This key is obtained by running
.I sdongle(1)
on the target host.
.br

.SH BUGS
At present the
.I disk serial
authentication mechanism only works for
.B ATAPI
not
.B SCSI
disks.
.br

.SH COPYRIGHT
(C) Tumbling Dice Ltd.
.br

.SH PROGRAMMER
M.A. O'Neill.
 
.SH SEE ALSO
configure(1), hdid(1), sdongle(1)
.br
